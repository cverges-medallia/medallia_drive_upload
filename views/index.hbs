<style type="text/css">
	.driveList{
		width: 300px;
	}
	.driveList a img{
		width: 120px;
		height: 112px;
		display: inline-block;
	}
	.driveList a img:hover{
		opacity:0.5;
	}
	#dropbox{	
	}
	#box{
	}
	#gDrive{
	}
	#oneDrive{
	}
</style>
<!-- Dropbox SDK -->
<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="yhp8797q6qg7wju"></script> 
<!-- Box SDK -->
<script type="text/javascript" src="https://cdn01.boxcdn.net/js/static/select.js"></script>
<!-- OneDrive SDK -->
<script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
<!-- gDrive SDK -->
<!-- -->
<script type="text/javascript" >
	document.onreadystatechange = () => {
		if (document.readyState === 'complete') {
			// ---- SHARED CONFIG ----
			options = {
				// Dropbox widget initialization
				dropbox:{
					// Required. Called when a user selects an item in the Chooser.
				    success: function(files) {
				    	// Replace target of the form to include the file download url as a parameter
				        document.getElementById("fileUrl").value=files[0].link;
				        document.getElementById("fileName").innerHTML=files[0].name;
				        document.getElementById("uploadButton").style.display="block";
				    },
				    // Optional. "preview" (default) is a preview link to the document for sharing,
				    // "direct" is an expiring link to download the contents of the file. For more
				    // information about link types, see Link types below.
				    linkType: "direct", // or "direct"
				    // Optional. A value of false (default) limits selection to a single file, while
				    // true enables multiple file selection.
				    multiselect: false // or true
				},
				// Box widget initialization
				box:{
					clientId: 'n321brgjwoarbbmyhbu4ldbggd8tdqjb',
				    linkType: 'direct',
				    multiselect: false
				},
				// gDrive to be added here
				// oneDrive to be added here
				oneDrive:{
					//thNHWQF2{?[vknnvFR6298= app password
					clientId: "7b87525d-393b-4524-adb1-67e9eaa51203",
					action: "download",
					multiSelect: false,
					advanced: {},
					success: function(files) {
					 	console.log(files);
						console.log(files.value);
						console.log(files.value[0]);
						document.getElementById("fileUrl").value=files.value[0]['@microsoft.graph.downloadUrl'];
				        document.getElementById("fileName").innerHTML=files.value[0].name;
				        document.getElementById("uploadButton").style.display="block";
					},
					cancel: function() { /* cancel handler */ },
					error: function(e) { /* error handler */ }
				}
			};

		    // Tie buttons with popup launcher
		    // Note to self: include tap event for mobile support
		    document.getElementById("dropbox").addEventListener('click', function() {
			    Dropbox.choose(options.dropbox);
			});
		    document.getElementById("box").addEventListener('click', function() {
			    boxSelect.launchPopup();
			});
			document.getElementById("gDrive").addEventListener('click', function() {
			});
		    document.getElementById("oneDrive").addEventListener('click', function() {
		    	OneDrive.open(options.oneDrive);
			});

		    // ---- SOLUTION SPECIFIC CONFIG ----
			// ---- Box rules ----
			var boxSelect = new BoxSelect(options.box);
		    // Successful callback handler
		    boxSelect.success(function(files) {
		        console.log(files);
		        // Replace target of the form to include the file download url as a parameter
		        document.getElementById("fileUrl").value=files[0].url;
		        document.getElementById("fileName").innerHTML=files[0].name;
		        document.getElementById("uploadButton").style.display="block";
		        boxSelect.closePopup();
		    });
		    // Cancel callback handler
		    boxSelect.cancel(function() {
		        console.log("The user clicked cancel or closed the popup");
		    });
		}	
	};
</script>
<table>
	<tr>
		<td class="driveList">
			<a id="dropbox"><img src="data:image/png;base64,{{dropboxLogo}}"/></a>
			<a id="box"><img src="data:image/png;base64,{{boxLogo}}"/></a>
			<a id="gDrive"><img src="data:image/png;base64,{{gDriveLogo}}"/></a><!-- AIzaSyCGKo2AQlmFJ2BqowpsDmeYf3gmv7DVZ3Y -->
			<a id="oneDrive"><img src="data:image/png;base64,{{oneDriveLogo}}"/></a>
		</td>
		<td>
			<div class="fileView">
				<center>
					<!-- Dynamic content to be generated here -->
					<span id="fileName">...</span><br/><br/>
					<form enctype="application/x-www-form-urlencoded" id="uploadForm" name="uploadForm" method="post" action="/">
						<input id="uploadUrl" name="uploadUrl" type="hidden" value="{{uploadUrl}}">
						<input id="username" name="username" type="hidden" value="{{username}}">
						<input id="pwd" name="pwd" type="hidden" value="{{pwd}}">
						<input id="fileUrl" name="fileUrl" type="hidden" value="">
						<input id="uploadButton" style="display:none" type="submit" value="Upload file">
					</form>
				</center>
			</div>
		</td>
	</tr>
</table>